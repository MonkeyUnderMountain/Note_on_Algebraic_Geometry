\section{Stacks in category theory}

\subsection{Prestacks}

    \begin{definition}\label{def:strongly_Cartesian_morphism}
        Let \(\bfS\) be a site and \(\bfp: \bfX \to \bfS\) a functor.
        A morphism \(f: a \to b\) in \(\bfX\) is called \emph{strongly Cartesian} if for every object \(c \in \Obj(\bfX)\), the diagram
        \[ \begin{tikzcd}
            \Hom_{\bfX}(c, a) \arrow[r, "f \circ -"] \arrow[d, "\bfp"'] & \Hom_{\bfX}(c, b) \arrow[d, "\bfp"] \\
            \Hom_{\bfS}(\bfp(c), \bfp(a)) \arrow[r, "\bfp(f) \circ -"] & \Hom_{\bfS}(\bfp(c), \bfp(b))
        \end{tikzcd} \]
        is a pullback of sets.
    \end{definition}

    \begin{notation}\label{notation:object_and_morphisms_over_base}
        Let \(\bfS\) be a site and \(\bfp: \bfX \to \bfS\) a functor.
        For \(a,b \in \Obj(\bfX)\) and \(f\in \Hom_{\bfX}(a, b)\), we say that \(a\) is \emph{over} \(\bfp(a)\) and \(f\) is \emph{over} \(\bfp(f)\).
        In a diagram, we have 
        \[ \begin{tikzcd}
            \bfX \arrow[d, "\bfp"'] & a \arrow[d, mapsto] \arrow[r, "f"] & b \arrow[d, mapsto] \\
            \bfS & \bfp(a) \arrow[r, "\bfp(f)"] & \bfp(b)
        \end{tikzcd} \]
    \end{notation}

    \begin{definition}\label{def:fibered_categories}
        Let \(\bfS\) be a site.
        A category \(\bfX\) over \(\bfS\) via \(\bfp\) is called a \emph{category fibred} over the site \(\bfS\) if
        for every morphism \(r: u\to v\) in \(\bfS\) and every object \(b \in \Obj(\bfX)\) over \(v\), there exists an object \(a \in \Obj(\bfX)\) over \(u\) and a strongly Cartesian morphism \(f: a \to b\) over \(r\).
        Such an object \(a\) is called a \emph{pullback} of \(b\) along \(r\), and is often denoted by \(r^*b\).
    \end{definition}

    \begin{definition}\label{def:fiber_of_fiber_category}
        Let \(\bfS\) be a site and \(\bfp: \bfX \to \bfS\) a category fibred over \(\bfS\).
        For every object \(u \in \Obj(\bfS)\), the \emph{fiber} of \(\bfX\) over \(u\) is the category \(\bfX_u\) given by
        \[ \Obj(\bfX_u) = \{ a \in \Obj(\bfX) \mid \bfp(a) = u \}, \quad \Hom_{\bfX_u}(a,b) = \{ f \in \Hom_{\bfX}(a,b) \mid \bfp(f) = \id_u \}. \]
    \end{definition}

    \begin{remark}\label{rmk:choice_of_pullback_in_fibered_category}
        Note that in Definition \ref{def:fibered_categories}, the pullback \(r^*b\) of an object \(b\) along a morphism \(r\) is not necessarily unique.
        \Yang{To be continued.}
    \end{remark}

    \Yang{Why do we need the Cartesian morphisms exists?}

    \begin{remark}
        \Yang{presheaves as category fibered in set, right?}
    \end{remark}

    \begin{slogan}\label{slogan:presheaf_is_set-fibered_category}
        Presheaf is a category fibered in sets.
    \end{slogan}

    \begin{definition}\label{def:prestacks_as_functor}
        A \emph{prestack} over the site \(\bfS\) is a category \(\bfX\) fibered in groupoids over \(\bfS\) via \(\bfp: \bfX \to \bfS\).
        \Yang{To be revised.}
    \end{definition}

    % \begin{proposition}\label{prop:prestack_is_a_category_fibred_by_groupoids}
    %     A functor \(\bfp: \bfX \to \bfS\) is a prestack over the site \(\bfS\) if and only if \(\bfX\) is a category fibred in groupoids over \(\bfS\) and for every object \(U \in \Obj(\bfS)\) and every pair of objects \(a,b \in \Obj(\bfX)\) over \(U\), the presheaf
    %     \[\underline{\Hom}_U(a,b): (\bfS/U)^{op} \to \Set \]
    %     defined by
    %     \[ (V \xrightarrow{g} U) \mapsto \Hom_{\bfX_V}(g^*a, g^*b) \]
    %     is a sheaf on the site \(\bfS/U\).
    %     \Yang{To be checked.}
    % \end{proposition}

    \begin{remark}\label{rmk:prestack_compares_with_presheaf_as_functor}
        Let \(\bfS\) be a site.
        A presheaf of sets on \(\bfS\) can be viewed as a functor \(\bfS^{op} \to \Set\).
        A prestack over \(\bfS\) can be viewed as a functor \(\bfS^{op} \to \Grpd\) by associating to each object \(u \in \Obj(\bfS)\) the fiber category \(\bfX_u\), which is a groupoid, and to each morphism \(u \to v\) in \(\bfS\) the pullback functor \(\bfX_v \to \bfX_u\).
        Thus, prestacks can be seen as a generalization of presheaves of sets, where the values are groupoids instead of sets.
        \Yang{To be checked.}
    \end{remark}

    \begin{slogan}\label{slogan:prestack_and_presheaf}
        Prestacks are ``presheaf remembering automorphisms''.
    \end{slogan}

    \Yang{Where is the 2-category?}

    \begin{theorem}[Yoneda 2-Lemma]\label{thm:Yoneda_2_lemma}
        Let \(\bfS\) be a site, and let \(\bfp: \bfX \to \bfS\) and \(\bfq: \bfY \to \bfS\) be prestacks over \(\bfS\).
        Then the functor
        \[
            \Fun_{\bfS}(\bfX, \bfY) \to (\bfp_*, \bfq_*)
        \]
        given by \(\Phi \mapsto \Phi_*\) is an equivalence of categories.
        \Yang{To be revised.}
    \end{theorem}


    \begin{theorem}\label{thm:existence_of_fiber_product_of_prestacks}
        Let \(\bfS\) be a site, and let \(\bfp: \bfX \to \bfS\), \(\bfq: \bfY \to \bfS\), and \(\bfr: \bfZ \to \bfS\) be prestacks over \(\bfS\).
        Let \(\Phi: \bfX \to \bfZ\) and \(\Psi: \bfY \to \bfZ\) be morphisms of prestacks over \(\bfS\).
        Then the fiber product \(\bfX \times_{\bfZ} \bfY\) exists in the category of prestacks over \(\bfS\).
        \Yang{To be checked.}
    \end{theorem}


\subsection{Descent conditions}

    \begin{definition}\label{def:descent_data_in_categories}
        Let \(\bfS\) be a site and \(\bfp: \bfX \to \bfS\) a fibered category over \(\bfS\).
        Let \(U \in \Obj(\bfS)\) and \(\{ U_i \to U \}\) be a covering in \(\bfS\).
        A \emph{descent datum} for objects of \(\bfX\) relative to the covering \(\{ U_i \to U \}\) consists of
        \begin{itemize}
            \item a collection of objects \(a_i \in \Obj(\bfX_{U_i})\) for each \(i\),
            \item a collection of isomorphisms \(\varphi_{ij}: a_j|_{U_{ij}} \to a_i|_{U_{ij}}\) in \(\bfX_{U_{ij}}\) for each pair \((i,j)\), where \(U_{ij} = U_i \times_U U_j\),
        \end{itemize}
        such that the cocycle condition
        \[ \varphi_{ik}|_{U_{ijk}} = \varphi_{ij}|_{U_{ijk}} \circ \varphi_{jk}|_{U_{ijk}} \]
        holds for all triples \((i,j,k)\), where \(U_{ijk} = U_i \times_U U_j \times_U U_k\).
        \Yang{To be checked.}
    \end{definition}


    \begin{definition}\label{def:effective_descent_data_in_categories}
        Let \(\bfS\) be a site and \(\bfp: \bfX \to \bfS\) a fibered category over \(\bfS\).
        A descent datum \((\{ a_i \}, \{ \varphi_{ij} \})\) for objects of \(\bfX\) relative to a covering \(\{ U_i \to U \}\) in \(\bfS\) is called \emph{effective} if there exists an object \(a \in \Obj(\bfX_U)\) and isomorphisms \(\psi_i: a|_{U_i} \to a_i\) in \(\bfX_{U_i}\) such that for all pairs \((i,j)\), the diagram
        \[ \begin{tikzcd}
            a|_{U_{ij}} \arrow[r, "\psi_j|_{U_{ij}}"] \arrow[d, "\psi_i|_{U_{ij}}"'] & a_j|_{U_{ij}} \arrow[d, "\varphi_{ij}"] \\
            a_i|_{U_{ij}} \arrow[r, "\varphi_{ij}"'] & a_j|_{U_{ij}}
        \end{tikzcd} \]
        commutes.
        \Yang{To be checked.}
    \end{definition}

    \begin{slogan}\label{slogan:descent_data_and_effectiveness}
        Descent data are like gluing data for objects, and effectiveness means that the glued object exists.
    \end{slogan}


\subsection{Stacks}

    \begin{definition}\label{def:stacks_in_categories}
        Let \(\bfS\) be a site.
        A prestack \(\bfp: \bfX \to \bfS\) is called a \emph{stack} over the site \(\bfS\) if for every object \(U \in \Obj(\bfS)\) and every covering \(\{ U_i \to U \}\) in \(\bfS\), the descent data for objects of \(\bfX\) relative to the covering \(\{ U_i \to U \}\) are effective.
        \Yang{To be revised.}
    \end{definition}

    \begin{slogan}\label{slogan:stacks_and_sheaves}
        Stacks to prestacks are like sheaves to presheaves.
    \end{slogan}


    \begin{definition}\label{def:quotient_stack}
        Let \(\bfS\) be a site, and let \(G\) be a group object in \(\bfS\) acting on an object \(X \in \Obj(\bfS)\).
        The \emph{quotient stack} \([X/G]\) is the stack over \(\bfS\) defined as follows:
        \begin{itemize}
            \item For each object \(U \in \Obj(\bfS)\), the groupoid \([X/G](U)\) has as objects the pairs \((P, f)\), where \(P\) is a \(G\)-torsor over \(U\) and \(f: P \to X\) is a \(G\)-equivariant morphism.
            \item Morphisms between two objects \((P, f)\) and \((P', f')\) in \([X/G](U)\) are given by \(G\)-equivariant morphisms \(\varphi: P \to P'\) such that \(f' \circ \varphi = f\).
        \end{itemize}
        The assignment \(U \mapsto [X/G](U)\) defines a stack over \(\bfS\).
        \Yang{To be checked.}
    \end{definition}