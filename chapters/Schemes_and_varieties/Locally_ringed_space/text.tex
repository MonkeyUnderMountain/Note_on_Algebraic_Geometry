\section{Locally Ringed Space}

\subsection{Sheaves}

    \begin{definition}\label{def:sheaves}
        Let \(X\) be a topological space.
        A \emph{presheaf} of sets (resp. abelian groups, rings, etc.) on \(X\) is a contravariant functor \(\calF : \Open(X) \to \Set\) (resp. \(\Ab\), \(\Ring\), etc.), 
        where \(\Open(X)\) is the category of open subsets of \(X\) with inclusions as morphisms.

        A presheaf \(\calF\) is a \emph{sheaf} if sections can be glued uniquely.
        More precisely, for every open covering \(\{U_i\}_{i \in I}\) of an open set \(U \subset X\) and every family of sections \(s_i \in \calF(U_i)\) such that \(s_i|_{U_i \cap U_j} = s_j|_{U_i \cap U_j}\) for all \(i,j \in I\),
        there exists a unique section \(s \in \calF(U)\) such that \(s|_{U_i} = s_i\) for all \(i \in I\).
    \end{definition}

    For two open sets \(V \subset U \subset X\), the morphism \(\calF(U) \to \calF(V)\), often denoted by \(\res^U_V\), is called the \emph{restriction map}.

    \begin{example}\label{eg:sheaf_of_smooth_and_analytic_functions}
        Let \(X\) be a real (resp. complex) manifold.
        The assignment \(U \mapsto C^\infty(U, \bbR)\) (resp. \(U \mapsto \{\text{holomorphic functions on }U\}\)) defines a sheaf of rings on \(X\).
    \end{example}

    \begin{example}\label{eg:presheaf_but_not_sheaf}
        Let \(X\) be a non-connected topological space.
        The assignment 
        \[U \mapsto \{\text{constant functions on }U \to \bbR\}\] 
        defines a presheaf \(\calC\) of rings on \(X\) but not a sheaf.

        For a concrete example, let \(X = (0,1)\cup (2,3)\) with the subspace topology from \(\bbR\).
        Consider the open covering \(\{(0,1), (2,3)\}\) of \(X\).
        The sections \(s_1 = 1 \in \calC((0,1))\) and \(s_2 = 2 \in \calC((2,3))\) agree on the intersection (which is empty), 
        but there is no global section \(s \in \calC(X)\) such that \(s|_{(0,1)} = s_1\) and \(s|_{(2,3)} = s_2\).
    \end{example}

    \begin{definition}\label{def:morphism_of_sheaves_and_presheaves}
        Let \(X\) be a topological space and \(\calF, \calG\) be presheaves on \(X\) with values in the same category (e.g., \(\Set\), \(\Ab\), \(\Ring\), etc.).
        A \emph{morphism of presheaves} \(\varphi : \calF \to \calG\) is a natural transformation between the functors \(\calF\) and \(\calG\).
        In other words, for every open set \(U \subset X\), there is a morphism \(\varphi(U) : \calF(U) \to \calG(U)\) such that for every inclusion of open sets \(V \subset U\), the following diagram commutes:
        \[
            \begin{tikzcd}
                \calF(U) \arrow[r, "\varphi(U)"] \arrow[d, "\res^U_V"'] & \calG(U) \arrow[d, "\res^U_V"] \\
                \calF(V) \arrow[r, "\varphi(V)"'] & \calG(V).
            \end{tikzcd}
        \]

        If \(\calF\) and \(\calG\) are sheaves, then \(\varphi\) is called a \emph{morphism of sheaves}.
    \end{definition}

    Fix a topological space \(X\) and a category \(\bfC\).
    The sheaves (resp. presheaves) on \(X\) with values in \(\bfC\) form a category, denoted by \(\Sh(X, \bfC)\) (resp. \(\PSh(X, \bfC)\)), 
    where the objects are sheaves (resp. presheaves) on \(X\) with values in \(\bfC\) and the morphisms are morphisms of sheaves (resp. presheaves).

    \begin{definition}\label{def:stalk_of_sheaves}
        Let \(X\) be a topological space and \(\calF\) a presheaf on \(X\) with values in a category \(\bfC\).
        For a point \(x \in X\), the \emph{stalk} of \(\calF\) at \(x\), denoted by \(\calF_x\), is defined as the colimit
        \[
            \calF_x := \varinjlim_{U \ni x} \calF(U),
        \]
        where the colimit is taken over all open neighborhoods \(U\) of \(x\).
        An element of \(\calF_x\) is called a \emph{germ} of sections of \(\calF\) at \(x\).
    \end{definition}

    More concretely, we have 
    \[ \calF_x = \{(U,s) : U \in \Open(X), U \ni x, s \in \calF(U)\} / \sim, \]
    where \((U,s) \sim (V,t)\) if there exists an open neighborhood \(W \subset U \cap V\) of \(x\) such that \(s|_W = t|_W\).

    \begin{definition}\label{def:sheafification_of_presheaf}
        Let \(X\) be a topological space and \(\calF\) a presheaf on \(X\) with values in \(\Set\) (resp. \(\Ab\), \(\Ring\), etc.).
        A \emph{sheafification} of \(\calF\) is a sheaf \(\calF^\dagger\) on \(X\) together with a morphism of presheaves \(\eta : \calF \to \calF^+\) such that for every sheaf \(\calG\) on \(X\) and every morphism of presheaves \(\varphi : \calF \to \calG\), 
        there exists a unique morphism of sheaves \(\varphi^+ : \calF^+ \to \calG\) such that \(\varphi = \varphi^+ \circ \eta\).
        
        In other words, the following diagram commutes:
        \[
            \begin{tikzcd}
                \calF \arrow[r, "\eta"] \arrow[rd, "\varphi"'] & \calF^\dagger \arrow[d, "\varphi^\dagger"] \\
                & \calG.
            \end{tikzcd}
        \]
        \Yang{To be checked.}
    \end{definition}

    \Yang{The concrete describe of sheafification.}

    % Now we consider \(\Sh(X, \Ab)\).

    \begin{definition}\label{def:injective_and_surjective_of_homomorphism_of_sheaves}
        Let \(X\) be a topological space and \(\varphi : \calF \to \calG\) be a homomorphism of sheaves of abelian groups on \(X\).
        The morphism \(\varphi\) is called \emph{injective} (resp. \emph{surjective}) if for every \(x \in X\), the map \(\varphi_x : \calF_x \to \calG_x\) is injective (resp. surjective).
    \end{definition}

    \begin{proposition}\label{prop:injective_on_section_iff_on_stalk_sheaves}
        Let \(X\) be a topological space and \(\varphi : \calF \to \calG\) be a homomorphism of sheaves of abelian groups on \(X\).
        Then \(\varphi\) is injective if and only if for every open set \(U \subset X\), the map \(\varphi(U) : \calF(U) \to \calG(U)\) is injective.
        \Yang{To be checked.}
    \end{proposition}

    \begin{remark}\label{prop:surjective_on_stalk_cannot_imply_on_sections}
        The surjectivity on stalks cannot imply the surjectivity on sections.
        A counterexample is given by the exponential map \(\exp : \calO_\bbC \to \calO_\bbC^*\) defined by \(\exp(f) = e^{f}\), 
        where \(\calO_\bbC\) is the sheaf of holomorphic functions on \(\bbC\) and \(\calO_\bbC^*\) is the sheaf of non-vanishing holomorphic functions on \(\bbC\).
        The induced map on stalks \(\exp_z : \calO_{\bbC,z} \to \calO_{\bbC,z}^*\) is surjective for every \(z \in \bbC\) by the existence of logarithm locally.
        However, the map on global sections \(\exp(\bbC) : \calO_\bbC(\bbC) \to \calO_\bbC^*(\bbC)\) is not surjective since there is no entire function \(f\) such that \(e^{f(z)} = z\) for all \(z \in \bbC^*\).
        \Yang{To be continued.}
        \Yang{This is wrong, need to be revised.}
    \end{remark}

    \begin{proposition}\label{prop:isomorphism_of_homomorphism_of_sheaves}
        Let \(X\) be a topological space and \(\varphi : \calF \to \calG\) be a homomorphism of sheaves of abelian groups on \(X\).
        Then \(\varphi\) is an isomorphism if and only if it is injective and surjective.
    \end{proposition}

    \Yang{Now we consider sheaves with values in an abelian category.}

    \begin{definition}\label{def:ker_and_cokernel_of_homomorphisms_of_sheaves}
        Let \(X\) be a topological space and \(\varphi : \calF \to \calG\) be a homomorphism of sheaves of abelian groups on \(X\).
        The \emph{kernel} of \(\varphi\), denoted by \(\ker \varphi\), is the sheaf defined by 
        \[
            (\ker \varphi)(U) := \ker(\varphi(U) : \calF(U) \to \calG(U))
        \]
        for every open set \(U \subset X\).

        The \emph{cokernel} of \(\varphi\), denoted by \(\coker \varphi\), is the sheafification of the presheaf defined by 
        \[
            (\coker \varphi)_{\text{pre}}(U) := \coker(\varphi(U) : \calF(U) \to \calG(U))
        \]
        for every open set \(U \subset X\).
        \Yang{To be continued.}
    \end{definition}

    \begin{theorem}\label{thm:sheaves_on_topological_space_is_an_abelian_category}
        Let \(X\) be a topological space and \(\bfC\) be an abelian category (e.g., \(\Ab\)).
        Then the category of sheaves on \(X\) with values in \(\bfC\) is an abelian category.
    \end{theorem}
    \begin{proof}
        \Yang{To be continued.}
    \end{proof}

    \Yang{To be checked and continuous.}


\subsection{Locally ringed space}

       \begin{definition}\label{def:push_forward_of_sheaves}
        Let \(f : X \to Y\) be a continuous map between topological spaces.
        The \emph{push-forward} functor \(f_* : \Sh(X, \bfC) \to \Sh(Y, \bfC)\) is defined by 
        \[
            (f_*\calF)(V) := \calF(f^{-1}(V))
        \]
        for every open set \(V \subset Y\) and sheaf \(\calF \in \Sh(X, \bfC)\).
    \end{definition}
    
    \begin{definition}\label{def:locally_ringed_space}
        A \emph{locally ringed space} is a pair \((X, \calO_X)\) where \(X\) is a topological space and \(\calO_X\) is a sheaf of rings on \(X\) such that for every \(x \in X\), the stalk \(\calO_{X,x}\) is a local ring.
        
        A \emph{morphism of locally ringed spaces} \(f : (X, \calO_X) \to (Y, \calO_Y)\) consists of a continuous map \(f : X \to Y\) and a morphism of sheaves of rings \(f^\sharp : \calO_Y \to f_*\calO_X\) 
        such that for every \(x \in X\), the induced map on stalks \(f_x^\sharp : \calO_{Y,f(x)} \to \calO_{X,x}\) is a local homomorphism, 
        i.e., it maps the maximal ideal of \(\calO_{Y,f(x)}\) to the maximal ideal of \(\calO_{X,x}\).
    \end{definition}

    \begin{example}\label{eg:non_local_homomorphism_of_local_rings}
        Let \(p\) be a prime number.
        Then the inclusion \(\bbZ_{(p)} \to \bbQ\) is a homomorphism of local rings but not a local homomorphism.
        Here \(\bbZ_{(p)}\) is the localization of \(\bbZ\) at the prime ideal \((p)\).
    \end{example}

    \begin{construction}[Glue morphisms]\label{constr:glue_morphisms_of_locally_ringed_spaces}
        Let \(f : (X, \calO_X) \to (Y, \calO_Y)\) be a morphism of locally ringed spaces.
        If \(U \subset X\) and \(V \subset Y\) are open subsets such that \(f(U) \subset V\), then the restriction \(f|_U : (U, \calO_X|_U) \to (V, \calO_Y|_V)\) is a morphism of locally ringed spaces.
        Conversely, if \(\{U_i\}_{i \in I}\) is an open covering of \(X\) and for each \(i \in I\), we have a morphism \(f_i : (U_i, \calO_X|_{U_i}) \to (Y, \calO_Y)\) such that \(f_i|_{U_i \cap U_j} = f_j|_{U_i \cap U_j}\) for all \(i,j \in I\),
        then there exists a unique morphism \(f : (X, \calO_X) \to (Y, \calO_Y)\) such that \(f|_{U_i} = f_i\) for all \(i \in I\).
    \end{construction}

    \begin{construction}[Glue locally ringed space]\label{constr:glue_open_locally_ringed_subspace}
        We construct a locally ringed space by gluing open subspaces.
        Let \((X_i, \calO_{X_i})\) be locally ringed spaces for \(i \in I\) and \((U_{ij}, \calO_{X_i}|_{U_{ij}})\) be open subspaces for \(i,j \in I\).
        Suppose we have isomorphisms \(\varphi_{ij} : (U_{ij}, \calO_{X_i}|_{U_{ij}}) \to (U_{ji}, \calO_{X_j}|_{U_{ji}})\) such that
        \begin{enumerate}
            \item \(\varphi_{ii} = \id_{X_i}\) for all \(i \in I\);
            \item \(\varphi_{ij}(U_{ij} \cap U_{ik}) = U_{ji} \cap U_{jk}\) for all \(i,j \in I\);
            \item \(\varphi_{jk}\circ \varphi_{ij} = \varphi_{ik}\) on \(U_{ij} \cap U_{ik}\) for all \(i,j,k \in I\).
        \end{enumerate}
        Then there exists a locally ringed space \((X, \calO_X)\) and open immersions \(\psi_i : (X_i, \calO_{X_i}) \to (X, \calO_X)\) uniquely up to isomorphism such that 
        \begin{enumerate}
            \item \(\varphi_i(U_{ij}) = \psi_i(X_i)\cap \psi_j(X_j)\) for all \(i,j \in I\);
            \item the following diagram 
                \[ \begin{tikzcd}
                    (U_{ij}, \calO_{X_i}|_{U_{ij}}) \arrow[d, "\varphi_{ij}"'] \arrow[r, hook] & (X_i, \calO_{X_i}) \arrow[r, hook, "\psi_i"] & (X, \calO_X) \arrow[d, "="] \\
                    (U_{ji}, \calO_{X_j}|_{U_{ji}}) \arrow[r, hook] & (X_j, \calO_{X_j}) \arrow[r, hook, "\psi_j"] & (X, \calO_X)
                \end{tikzcd} \]
                commutes for all \(i,j \in I\);
            \item \(X = \bigcup_{i \in I} \psi_i(X_i)\).
        \end{enumerate}
        Such \((X, \calO_X)\) is called \emph{the locally ringed space obtained by gluing the \((X_i, \calO_{X_i})\) along the \(\varphi_{ij}\)}.
        
        First \(\varphi_{ij}\) induces an equivalence relation \(\sim\) on the disjoint union \(\coprod_{i \in I} X_i\).
        By taking the quotient space, we can glue the underlying topological spaces to get a topological space \(X\).
        The structure sheaf \(\calO_X\) is given by 
        \[ \calO_X(V) := \left\{ (s_i)_{i \in I} \in \prod_{i \in I} \calO_{X_i}(\psi_i^{-1}(V)) \;\middle|\; s_i|_{U_{ij}} = \varphi_{ij}^\sharp(s_j|_{U_{ji}}) \text{ for all } i,j \in I \right\}. \]
        Easy to check that \((X, \calO_X)\) is a locally ringed space and satisfies the required properties.
        If there is another locally ringed space \((X', \calO_{X'})\) with \(\psi'_i\) satisfying the same properties, then by gluing \(\psi_i' \circ \psi_i^{-1}\) we get an isomorphism \((X, \calO_X) \to (X', \calO_{X'})\).
    \end{construction}

    \begin{definition}\label{def:closed_and_open_immersion_of_locally_ringed_space}
        A morphism of locally ringed spaces \(f : (X, \calO_X) \to (Y, \calO_Y)\) is called a \emph{closed immersion} (resp. \emph{open immersion}) if 
        \(f\) induces a homeomorphism from \(X\) to a closed (resp. open) subset of \(Y\) and the map \(f^\sharp : \calO_Y \to f_*\calO_X\) is surjective (resp. an isomorphism).
        \Yang{To be checked.}
    \end{definition}



\subsection{Manifolds as locally ringed spaces}


    

\subsection[Vector bundles and O\_X-modules]{Vector bundles and \(\calO_X\)-modules}

    Let \((X,\calO_X)\) be a manifold (real or complex) and \((\calE, \pi, X)\) a vector bundle over \(X\).

    \Yang{It can regard as a sheaf on \(X\).}

    \begin{definition}\label{def:sheaf_of_modules}
        Let \((X,\calO_X)\) be a ringed space.
        A \emph{sheaf of \(\calO_X\)-modules} is a sheaf \(\calF\) of abelian groups on \(X\) such that for every open set \(U\subseteq X\), 
        \(\calF(U)\) is an \(\calO_X(U)\)-module, 
        and for every inclusion of open sets \(V\subseteq U\), the restriction map \(\res_{UV}:\calF(U)\to \calF(V)\) is \(\calO_X(U)\)-linear, 
        where the \(\calO_X(U)\)-module structure on \(\calF(V)\) is induced by the restriction map \(\res_{UV}:\calO_X(U)\to \calO_X(V)\).
        
        A \emph{morphism of \(\calO_X\)-modules} is a morphism of sheaves of abelian groups \(\varphi:\calF\to \calG\) such that 
        for every open set \(U\subseteq X\), the map \(\varphi(U):\calF(U)\to \calG(U)\) is \(\calO_X(U)\)-linear.
        \Yang{To be checked...}
    \end{definition}

    % \Yang{We will try to construct a sequence of subcategories of \(\Mod_{\calO_X}\).}

    % \begin{definition}\label{def:finitely_generated_O_X_modules}
    %     A sheaf of \(\calO_X\)-modules \(\calF\) is said to be \emph{finitely generated} if for every open set \(U \subseteq X\), the \(\calO_X(U)\)-module \(\calF(U)\) is finitely generated.
    %     \Yang{To be continued.}
    % \end{definition}
    
    % \begin{remark}\label{rmk:local_properties_of_sheaves}
    %     There are many versions of ``local'' properties for sheaves of \(\calO_X\)-modules.
    %     \Yang{To be continued.}
    % \end{remark}

    \begin{definition}\label{def:locally_free_O_X_modules}
        A sheaf of \(\calO_X\)-modules \(\calF\) is said to be \emph{locally free of rank \(r\)} if for every point \(x \in X\), there exists an open neighborhood \(U\) of \(x\) such that \(\calF|_U\) is isomorphic to \(\calO_U^r\), 
        where \(\calO_U^r\) is the direct sum of \(r\) copies of \(\calO_U\).
        \Yang{To be continued.}
    \end{definition}

    % \begin{definition}\label{def:quasi_coherent_sheaves}
    %     A sheaf of \(\calO_X\)-modules \(\calF\) is said to be \emph{quasi-coherent} if for every point \(x \in X\), there exists an open neighborhood \(U\) of \(x\) such that \(\calF|_U\) is isomorphic to the cokernel of a morphism of free \(\calO_U\)-modules, i.e., there exists an exact sequence of sheaves of \(\calO_U\)-modules
    %     \[
    %         \calO_U^{(I)} \to \calO_U^{(J)} \to \calF|_U \to 0,
    %     \]
    %     where \(I,J\) are (possibly infinite) index sets.
    %     \Yang{To be checked...}
        
    % \end{definition}

    % \begin{definition}\label{def:coherent_sheaves}
    %     A sheaf of \(\calO_X\)-modules \(\calF\) is said to be \emph{coherent} if it is finitely generated, and for every open set \(U \subseteq X\) and every morphism of sheaves of \(\calO_U\)-modules \(\varphi:\calO_U^n \to \calF|_U\), the kernel of \(\varphi\) is finitely generated.
    %     \Yang{To be checked...}
    % \end{definition}


