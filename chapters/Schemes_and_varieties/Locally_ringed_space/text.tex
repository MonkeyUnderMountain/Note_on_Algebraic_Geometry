\section{Locally Ringed Space}

\subsection{Sheaves}

    \begin{definition}\label{def:sheaves}
        Let \(X\) be a topological space.
        A \emph{presheaf} of sets (resp. abelian groups, rings, etc.) on \(X\) is a contravariant functor \(\calF : \Open(X) \to \Set\) (resp. \(\Ab\), \(\Ring\), etc.), 
        where \(\Open(X)\) is the category of open subsets of \(X\) with inclusions as morphisms.

        A presheaf \(\calF\) is a \emph{sheaf} if sections can be glued uniquely.
        More precisely, for every open covering \(\{U_i\}_{i \in I}\) of an open set \(U \subset X\) and every family of sections \(s_i \in \calF(U_i)\) such that \(s_i|_{U_i \cap U_j} = s_j|_{U_i \cap U_j}\) for all \(i,j \in I\),
        there exists a unique section \(s \in \calF(U)\) such that \(s|_{U_i} = s_i\) for all \(i \in I\).
    \end{definition}

    \begin{example}\label{eg:sheaf_of_smooth_and_analytic_functions}
        Let \(X\) be a real (resp. complex) manifold.
        The assignment \(U \mapsto C^\infty(U, \bbR)\) (resp. \(U \mapsto \{\text{holomorphic functions on }U\}\)) defines a sheaf of rings on \(X\).
    \end{example}

    \begin{example}\label{eg:presheaf_but_not_sheaf}
        Let \(X\) be a non-connected topological space.
        The assignment 
        \[U \mapsto \{\text{constant functions on }U\}\] 
        defines a presheaf \(\calC\) of rings on \(X\) but not a sheaf.

        For a concrete example, let \(X = (0,1)\cup (2,3)\) with the subspace topology from \(\bbR\).
        Consider the open covering \(\{(0,1), (2,3)\}\) of \(X\).
        The sections \(s_1 = 1 \in \calC((0,1))\) and \(s_2 = 2 \in \calC((2,3))\) agree on the intersection (which is empty), 
        but there is no global section \(s \in \calC(X)\) such that \(s|_{(0,1)} = s_1\) and \(s|_{(2,3)} = s_2\).
    \end{example}


\subsection{Locally Ringed Space}

    \begin{definition}\label{def:locally_ringed_space}
        A \emph{locally ringed space} is a pair \((X, \calO_X)\) where \(X\) is a topological space and \(\calO_X\) is a sheaf of rings on \(X\) such that for every \(x \in X\), the stalk \(\calO_{X,x}\) is a local ring.
        
        A \emph{morphism of locally ringed spaces} \(f : (X, \calO_X) \to (Y, \calO_Y)\) consists of a continuous map \(f : X \to Y\) and a morphism of sheaves of rings \(f^\sharp : \calO_Y \to f_*\calO_X\) 
        such that for every \(x \in X\), the induced map on stalks \(f_x^\sharp : \calO_{Y,f(x)} \to \calO_{X,x}\) is a local homomorphism, 
        i.e., it maps the maximal ideal of \(\calO_{Y,f(x)}\) to the maximal ideal of \(\calO_{X,x}\).
    \end{definition}

    \begin{example}\label{eg:non_local_homomorphism_of_local_rings}
        Let \(p\) be a prime number.
        Then the inclusion \(\bbZ_{(p)} \to \bbQ\) is a homomorphism of local rings but not a local homomorphism.
        Here \(\bbZ_{(p)}\) is the localization of \(\bbZ\) at the prime ideal \((p)\).
    \end{example}

    \begin{example}[Glue morphisms]\label{eg:glue_morphisms_of_locally_ringed_spaces}
        Let \(f : (X, \calO_X) \to (Y, \calO_Y)\) be a morphism of locally ringed spaces.
        If \(U \subset X\) and \(V \subset Y\) are open subsets such that \(f(U) \subset V\), then the restriction \(f|_U : (U, \calO_X|_U) \to (V, \calO_Y|_V)\) is a morphism of locally ringed spaces.
        Conversely, if \(\{U_i\}_{i \in I}\) is an open covering of \(X\) and for each \(i \in I\), we have a morphism \(f_i : (U_i, \calO_X|_{U_i}) \to (Y, \calO_Y)\) such that \(f_i|_{U_i \cap U_j} = f_j|_{U_i \cap U_j}\) for all \(i,j \in I\),
        then there exists a unique morphism \(f : (X, \calO_X) \to (Y, \calO_Y)\) such that \(f|_{U_i} = f_i\) for all \(i \in I\).
    \end{example}

    \begin{example}[Glue locally ringed space]\label{eg:glue_open_locally_ringed_subspace}
        We construct a locally ringed space by gluing open subspaces.
        Let \((X_i, \calO_{X_i})\) be locally ringed spaces for \(i \in I\) and \((U_{ij}, \calO_{X_i}|_{U_{ij}})\) be open subspaces for \(i,j \in I\).
        Suppose we have isomorphisms \(\varphi_{ij} : (U_{ij}, \calO_{X_i}|_{U_{ij}}) \to (U_{ji}, \calO_{X_j}|_{U_{ji}})\) such that
        \begin{enumerate}
            \item \(\varphi_{ii} = \id_{X_i}\) for all \(i \in I\);
            \item \(\varphi_{ij}(U_{ij} \cap U_{ik}) = U_{ji} \cap U_{jk}\) for all \(i,j \in I\);
            \item \(\varphi_{jk}\circ \varphi_{ij} = \varphi_{ik}\) on \(U_{ij} \cap U_{ik}\) for all \(i,j,k \in I\).
        \end{enumerate}
        Then there exists a locally ringed space \((X, \calO_X)\) and open immersions \(\psi_i : (X_i, \calO_{X_i}) \to (X, \calO_X)\) uniquely up to isomorphism such that 
        \begin{enumerate}
            \item \(\varphi_i(U_{ij}) = \psi_i(X_i)\cap \psi_j(X_j)\) for all \(i,j \in I\);
            \item the following diagram 
                \[ \begin{tikzcd}
                    (U_{ij}, \calO_{X_i}|_{U_{ij}}) \arrow[d, "\varphi_{ij}"'] \arrow[r, hook] & (X_i, \calO_{X_i}) \arrow[r, hook, "\psi_i"] & (X, \calO_X) \arrow[d, "="] \\
                    (U_{ji}, \calO_{X_j}|_{U_{ji}}) \arrow[r, hook] & (X_j, \calO_{X_j}) \arrow[r, hook, "\psi_j"] & (X, \calO_X)
                \end{tikzcd} \]
                commutes for all \(i,j \in I\);
            \item \(X = \bigcup_{i \in I} \psi_i(X_i)\).
        \end{enumerate}
        Such \((X, \calO_X)\) is called \emph{the locally ringed space obtained by gluing the \((X_i, \calO_{X_i})\) along the \(\varphi_{ij}\)}.
        
        First \(\varphi_{ij}\) induces an equivalence relation \(\sim\) on the disjoint union \(\coprod_{i \in I} X_i\).
        By taking the quotient space, we can glue the underlying topological spaces to get a topological space \(X\).
        The structure sheaf \(\calO_X\) is given by 
        \[ \calO_X(V) := \left\{ (s_i)_{i \in I} \in \prod_{i \in I} \calO_{X_i}(\psi_i^{-1}(V)) \;\middle|\; s_i|_{U_{ij}} = \varphi_{ij}^\sharp(s_j|_{U_{ji}}) \text{ for all } i,j \in I \right\}. \]
        Easy to check that \((X, \calO_X)\) is a locally ringed space and satisfies the required properties.
        If there is another locally ringed space \((X', \calO_{X'})\) with \(\psi'_i\) satisfying the same properties, then by gluing \(\psi_i' \circ \psi_i^{-1}\) we get an isomorphism \((X, \calO_X) \to (X', \calO_{X'})\).
    \end{example}

\subsection{Manifolds as locally ringed spaces}

    

\subsection[Vector bundles and O\_X-modules]{Vector bundles and \(\calO_X\)-modules}

    \begin{definition}\label{def:sheaf_of_modules}
        Let \((X,\calO_X)\) be a ringed space.
        A \emph{sheaf of \(\calO_X\)-modules} is a sheaf \(\calF\) of abelian groups on \(X\) such that for every open set \(U\subseteq X\), 
        \(\calF(U)\) is an \(\calO_X(U)\)-module, 
        and for every inclusion of open sets \(V\subseteq U\), the restriction map \(\res_{UV}:\calF(U)\to \calF(V)\) is \(\calO_X(U)\)-linear, 
        where the \(\calO_X(U)\)-module structure on \(\calF(V)\) is induced by the restriction map \(\res_{UV}:\calO_X(U)\to \calO_X(V)\).
        
        A \emph{morphism of \(\calO_X\)-modules} is a morphism of sheaves of abelian groups \(\varphi:\calF\to \calG\) such that 
        for every open set \(U\subseteq X\), the map \(\varphi(U):\calF(U)\to \calG(U)\) is \(\calO_X(U)\)-linear.
        \Yang{To be checked...}
    \end{definition}

    \begin{example}\label{eg:module_as_sheaf_of_modules_in_affine_case}
        Let \(A\) be a ring and \(M\) an \(A\)-module.
        Let \(X = \Spec A\) with the Zariski topology and structure sheaf \(\calO_X\).
        Define a presheaf \(\widetilde{M}\) on \(X\) by 
        \[
            \widetilde{M}(D(f)) := M_f,
        \]
        where \(D(f) = \{p \in X : f \notin p\}\) and \(M_f = M \otimes_A A_f\).
        Then the sheafification of \(\widetilde{M}\), denoted by the same symbol, is a sheaf of \(\calO_X\)-modules on \(X\).
        The stalk at a point \(p \in X\) is given by \(\widetilde{M}_p = M_p\).
        In particular, if \(M = A\), then \(\widetilde{A} = \calO_X\).
        \Yang{To be checked...}
    \end{example}
